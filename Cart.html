<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cart - Swiggy Clone</title>
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(180deg, #fff7f2 0%, #fff 100%);
        margin: 0;
        padding: 0;
        color: #333;
      }

      .cart-container {
        max-width: 650px;
        margin: 60px auto;
        background: #fff;
        border-radius: 18px;
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        padding: 35px 28px;
        transition: 0.3s ease;
      }

      .cart-container:hover {
        box-shadow: 0 10px 28px rgba(0, 0, 0, 0.12);
      }

      h2 {
        text-align: center;
        margin-bottom: 30px;
        color: #fc8019;
        font-weight: 700;
        font-size: 26px;
        letter-spacing: 0.5px;
      }

      .back-link {
        display: inline-block;
        margin-bottom: 25px;
        color: #fc8019;
        text-decoration: none;
        font-weight: 500;
        font-size: 15px;
        transition: 0.3s;
      }

      .back-link:hover {
        text-decoration: underline;
      }

      .cart-list {
        list-style: none;
        padding: 0;
        margin: 0;
      }

      .cart-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #fffaf5;
        border: 1px solid #ffe1cc;
        border-radius: 14px;
        margin-bottom: 16px;
        padding: 12px 16px;
        transition: all 0.2s ease;
      }

      .cart-item:hover {
        background: #fff2e5;
        transform: translateY(-2px);
      }

      .cart-item img {
        width: 70px;
        height: 70px;
        object-fit: cover;
        border-radius: 10px;
        border: 1px solid #eee;
      }

      .item-details {
        display: flex;
        flex-direction: column;
        gap: 3px;
      }

      .cart-item-name {
        font-weight: 600;
        font-size: 16px;
      }

      .cart-item small {
        color: #777;
        font-size: 13px;
      }

      .qty-controls {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 6px;
      }

      .qty-btn {
        background: #fc8019;
        border: none;
        color: white;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        cursor: pointer;
        font-weight: bold;
        font-size: 18px;
        line-height: 30px;
        text-align: center;
        box-shadow: 0 2px 6px rgba(252, 128, 25, 0.4);
        transition: transform 0.2s, background 0.2s;
      }

      .qty-btn:hover {
        background: #ff9340;
        transform: scale(1.1);
      }

      .qty-number {
        min-width: 24px;
        text-align: center;
        font-size: 15px;
        font-weight: 500;
      }

      .remove-btn {
        background: #ff4d4d;
        color: #fff;
        border: none;
        padding: 7px 14px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 13px;
        font-weight: 500;
        transition: background 0.2s ease;
      }

      .remove-btn:hover {
        background: #ff2f2f;
      }

      .empty-cart {
        text-align: center;
        color: #999;
        margin: 40px 0;
        font-size: 15px;
      }

      .total-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-top: 1px solid #eee;
        padding-top: 18px;
        margin-top: 20px;
        font-size: 17px;
        font-weight: 600;
      }

      .checkout-btn {
        display: block;
        width: 100%;
        background: linear-gradient(90deg, #fc8019 0%, #ff9340 100%);
        color: #fff;
        border: none;
        padding: 15px 0;
        border-radius: 10px;
        font-size: 17px;
        font-weight: 600;
        cursor: pointer;
        margin-top: 25px;
        box-shadow: 0 4px 14px rgba(252, 128, 25, 0.4);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }

      .checkout-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 18px rgba(252, 128, 25, 0.5);
      }
      .order-history-btn {
        float: right;
        margin-top: -4px;
        background: #fc8019;
        color: #fff;
        border: none;
        padding: 10px 18px;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: 0.2s ease;
      }

      .order-history-btn:hover {
        background: rgba(252, 128, 25, 0.5);
      }
    </style>
  </head>
  <body>
    <div class="cart-container">
      <a href="SwiggyHomepage.html" class="back-link"
        >&larr; Continue Shopping</a
      >
      <button class="order-history-btn" id="orderHistoryBtn">
        Order History
      </button>
      <h2>Your Cart</h2>
      <ul class="cart-list" id="cartList"></ul>
      <div class="empty-cart" id="emptyCartMsg" style="display: none">
        Your cart is empty üçΩÔ∏è
      </div>
      <div class="total-section" id="totalSection" style="display: none">
        <span>Total:</span>
        <span id="totalPrice">‚Çπ0</span>
      </div>
      <button class="checkout-btn" id="checkoutBtn">Proceed to Checkout</button>
    </div>

    <script>
      // Retrieve and store cart items
      function getCartItems() {
        return JSON.parse(localStorage.getItem("swiggyCart")) || [];
      }

      function setCartItems(items) {
        localStorage.setItem("swiggyCart", JSON.stringify(items));
      }

      // Render cart with total
      function renderCart() {
        const cartList = document.getElementById("cartList");
        const emptyCartMsg = document.getElementById("emptyCartMsg");
        const totalSection = document.getElementById("totalSection");
        const totalPriceEl = document.getElementById("totalPrice");
        const checkoutBtn = document.getElementById("checkoutBtn");

        const items = getCartItems();
        cartList.innerHTML = "";

        if (items.length === 0) {
          emptyCartMsg.style.display = "block";
          totalSection.style.display = "none";
          checkoutBtn.disabled = true;
          checkoutBtn.style.opacity = "0.6";
        } else {
          emptyCartMsg.style.display = "none";
          totalSection.style.display = "flex";
          checkoutBtn.disabled = false;
          checkoutBtn.style.opacity = "1";

          let total = 0;

          items.forEach((item, idx) => {
            const qty = item.qty || 1;
            const price = item.price || 100; // default value if not available
            total += qty * price;

            const li = document.createElement("li");
            li.className = "cart-item";
            li.innerHTML = `
            <div style="display:flex;align-items:center;gap:15px;">
              <img src="${item.img}" alt="${item.name}">
              <div class="item-details">
                <div class="cart-item-name">${item.name}</div>
                <small>${item.restaurantName}</small>
                <div class="qty-controls">
                  <button class="qty-btn minus" data-idx="${idx}">-</button>
                  <div class="qty-number">${qty}</div>
                  <button class="qty-btn plus" data-idx="${idx}">+</button>
                </div>
              </div>
            </div>
            <div style="text-align:right;">
              <div style="font-weight:600;">‚Çπ${(qty * price).toFixed(0)}</div>
              <button class="remove-btn" data-idx="${idx}">Remove</button>
            </div>
          `;
            cartList.appendChild(li);
          });

          totalPriceEl.textContent = "‚Çπ" + total.toFixed(0);
        }
      }

      // Handle interactions
      document
        .getElementById("cartList")
        .addEventListener("click", function (e) {
          const items = getCartItems();
          const idx = e.target.getAttribute("data-idx");

          if (!idx) return;

          if (e.target.classList.contains("remove-btn")) {
            items.splice(idx, 1);
          } else if (e.target.classList.contains("plus")) {
            items[idx].qty = (items[idx].qty || 1) + 1;
          } else if (e.target.classList.contains("minus")) {
            if ((items[idx].qty || 1) > 1) {
              items[idx].qty -= 1;
            } else {
              items.splice(idx, 1);
            }
          }

          setCartItems(items);
          renderCart();
        });

      // Checkout
      document
        .getElementById("checkoutBtn")
        .addEventListener("click", function () {
          // Save the current cart as the order that will be processed
          const cartData = JSON.parse(localStorage.getItem("swiggyCart")) || [];
          localStorage.setItem("swiggyCurrentOrder", JSON.stringify(cartData));

          window.location.href = "checkout.html";
        });

      document
        .getElementById("orderHistoryBtn")
        .addEventListener("click", function () {
          window.location.href = "orderHistory.html";
        });

      renderCart();
    </script>
  </body>
</html>
